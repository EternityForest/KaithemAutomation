continual: false
enable: true
once: true
priority: interactive
rate-limit: 0.0
resource-type: event
trigger: 'True'
versions: {}

#End metadata. Format: metadata, setup, action, delimited by --- on it's own line.
---
#This code runs once when the event loads. It also runs when you save the event during the test compile
#and may run multiple times when kaithem boots due to dependancy resolution
__doc__="""This test is here because of a bug that caused a lockup where the workers task queue was full, but the workers were all trying
to insert things into the scheduler, and the scheduler was blocked trying to insert things into the worker queue. To my knowledge the 
bug only affect a few dev versions"""
import random,time
---
time.sleep(15)
def l1():
    kaithem.misc.do(l2)
def l2():
    kaithem.events.after(random.random()/200,l3)
def l3():
    pass

for i in range(0,1200):
    kaithem.misc.do(l1)
