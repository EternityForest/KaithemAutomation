continual: false
disabled: false
once: true
priority: interactive
rate-limit: 0.0
resource-type: event
trigger: 'True'
versions:
  action: "if os.path.isdir(\"/tmp\"):\r\n    x = kaithem.misc.lorem()\r\n    kaithem.persist.save(x,\"\
    /tmp/kpersisttest.txt\")\r\n    if not x == kaithem.persist.load(\"/tmp/kpersisttest.txt\"\
    ):\r\n        raise RuntimeError(\"Kaithem persist readback does match\")\r\n\
    \        \r\n    x = [1,2,3,4,5,6,7,8,9]\r\n    kaithem.persist.save(x,\"/tmp/kpersisttest.json\"\
    )\r\n    if not x == kaithem.persist.load(\"/tmp/kpersisttest.json\"):\r\n   \
    \     raise RuntimeError(\"Kaithem persist readback does match\")\r\n        \r\
    \n    kaithem.persist.save(x,\"/tmp/kpersisttest.yaml\")\r\n    if not x == kaithem.persist.load(\"\
    /tmp/kpersisttest.yaml\"):\r\n        raise RuntimeError(\"Kaithem persist readback\
    \ does match\")\r\n        \r\n    kaithem.persist.save(x,\"/tmp/kpersisttest.yaml.bz2\"\
    )\r\n    if not x == kaithem.persist.load(\"/tmp/kpersisttest.yaml.bz2\"):\r\n\
    \        raise RuntimeError(\"Kaithem persist readback does match\")\r\n     \
    \   \r\n    kaithem.persist.save(x,\"/tmp/kpersisttest.yaml.gz\")\r\n    if not\
    \ x == kaithem.persist.load(\"/tmp/kpersisttest.yaml.gz\"):\r\n        raise RuntimeError(\"\
    Kaithem persist readback does match\")\r\n        \r\n    kaithem.persist.save(b'test',\"\
    /tmp/kpersisttest.bin\")\r\n    if not b'test' == kaithem.persist.load(\"/tmp/kpersisttest.bin\"\
    ):\r\n        raise RuntimeError(\"Kaithem persist readback does match\")\r\n\
    \                         "
  continual: false
  priority: interactive
  rate-limit: 0.0
  resource-type: event
  setup: "#This code runs once when the event loads. It also runs when you save the\
    \ event during the test compile\r\n#and may run multiple times when kaithem boots\
    \ due to dependancy resolution\r\n__doc__=''\r\nipmort os"
  trigger: 'True'

---
#This code runs once when the event loads. It also runs when you save the event during the test compile
#and may run multiple times when kaithem boots due to dependancy resolution
__doc__='Test kaithem.persist functions'
import os
---
if os.path.isdir("/tmp"):
    x = kaithem.misc.lorem()
    kaithem.persist.save(x,"/tmp/kpersisttest.txt")
    if not x == kaithem.persist.load("/tmp/kpersisttest.txt"):
        raise RuntimeError("Kaithem persist readback does match")
        
    kaithem.persist.save(x,"/tmp/kpersisttest.txt.gz")
    if not x == kaithem.persist.load("/tmp/kpersisttest.txt.gz"):
        raise RuntimeError("Kaithem persist readback does match")
        
    kaithem.persist.save(x,"/tmp/kpersisttest.txt.bz2")
    if not x == kaithem.persist.load("/tmp/kpersisttest.txt.bz2"):
        raise RuntimeError("Kaithem persist readback does match")
        
    kaithem.persist.save(b'test' , "/tmp/kpersisttest.bin.bz2")
    if not b'test' == kaithem.persist.load("/tmp/kpersisttest.bin.bz2"):
        raise RuntimeError("Kaithem persist readback does match")
        
    kaithem.persist.save(b'test' , "/tmp/kpersisttest.bin.gz")
    if not b'test' == kaithem.persist.load("/tmp/kpersisttest.bin.gz"):
        raise RuntimeError("Kaithem persist readback does match")
        
    x = [1,2,3,4,5,6,7,8,9]
    kaithem.persist.save(x,"/tmp/kpersisttest.json")
    if not x == kaithem.persist.load("/tmp/kpersisttest.json"):
        raise RuntimeError("Kaithem persist readback does match")
        
    kaithem.persist.save(x,"/tmp/kpersisttest.yaml")
    if not x == kaithem.persist.load("/tmp/kpersisttest.yaml"):
        raise RuntimeError("Kaithem persist readback does match")
        
    kaithem.persist.save(x,"/tmp/kpersisttest.yaml.bz2")
    if not x == kaithem.persist.load("/tmp/kpersisttest.yaml.bz2"):
        raise RuntimeError("Kaithem persist readback does match")
        
    kaithem.persist.save(x,"/tmp/kpersisttest.yaml.gz")
    if not x == kaithem.persist.load("/tmp/kpersisttest.yaml.gz"):
        raise RuntimeError("Kaithem persist readback does match")
        
    kaithem.persist.save(x,"/tmp/kpersisttest.json.bz2")
    if not x == kaithem.persist.load("/tmp/kpersisttest.yaml.bz2"):
        raise RuntimeError("Kaithem persist readback does match")
        
    kaithem.persist.save(x,"/tmp/kpersisttest.json.gz")
    if not x == kaithem.persist.load("/tmp/kpersisttest.yaml.gz"):
        raise RuntimeError("Kaithem persist readback does match")
        
    kaithem.persist.save(b'test',"/tmp/kpersisttest.bin")
    if not b'test' == kaithem.persist.load("/tmp/kpersisttest.bin"):
        raise RuntimeError("Kaithem persist readback does match")
else:
	kaithem.message.post("/system/notifications/warnings","No /tmp directory on this system, could not test persistance files.")
                         