<%!
from src.util import url
from src import modules
%>
<%include file="/pageheader.html"/>
<h2> Modules <sup><a href="/docs#modules">[help]</a></sup></h2>
<title>Kaithem Modules</title>
<section>

    </div>
    <div class="buttonbar menubar">
    <a class="button" href="/modules/newmodule"><i class="icofont-ui-add"></i>Add</a>
    <a class="button" href="/modules/deletemodule"><i class="icofont-ui-delete"></i>Delete</a>
    <a class="button" href="/modules/upload"><i class="icofont-upload"></i>Upload</a>
    <a href="/modules/library"><i class="icofont-library"></i>Library</a>
    <form style="display:inline-flex;" action="/modules/search/__all__"><input name="search" size="4" placeholder="Search all modules"/><input type=submit value="search"/></form>
    </div>
    <div class="buttonbar">
        <p><b style="font-size: smaller;">${modules.moduleshash}</b></p>
    </div>
<p class="help">
The following modules are currently loaded and active on the server.
</p>

<hr>
<ul>
%for i in sorted(ActiveModules.keys()):
<li>\
%if i in modules.unsaved_changed_obj or i in [j[0] for j in modules.unsaved_changed_obj if isinstance(j,tuple)]:
*\
%endif
%try:
<a href="/modules/module/${url(i)}#resources" title="MD5: ${modules.getModuleHash(i)}">${i}</a>\
%if i in modules.external_module_locations:
[From ${modules.external_module_locations[i]|h}]\
%endif
</li>\
%except Exception as e:
${e|h}
%endtry
%endfor
</ul>
</section>
<%include file="/pagefooter.html"/>
