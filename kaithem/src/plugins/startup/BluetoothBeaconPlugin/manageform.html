<%!
from kaithem.src.kaithemobj import kaithem

%>



<h3>Info</h3>
<p class="warning">
Some people may wish to avoid carrying portable keychain type Eddystone beacons as other people within range could use them
to track you.
</p>


<p class="help">
This device scans for one Bluetooth Low Energy beacon. Currently all it does is make a tag point that tracks it's RSSI.
All BLE devices have a unique MAC address, use that to track this.  You need to refresh the page to update the autocomplete menu.

You may want to download a BLE scanner app from your phone's app store to see which address belongs to your device.

This requires that the process be root, or have the capabilities to do BT scanning.
</p>

<p>You need to connect this to an EspruinoHub client to make this work!</p>
<table>
    <tr>
        <td>MAC Address</td>
        <td><input list="ble" name="device.id" value="${data.get('device.id','')|h}"></td>
    </tr>
    <tr>
        <td>Expected beacon interval(Used for presence detection)</td>
        <td><input name="device.interval" value="${data.get('device.interval','5')|h}"></td>
    </tr>

    <tr>
        <td>MQTT server(user@server or just server for anon)</td>
        <td><input name="device.server" value="${data.get('device.server','localhost')|h}" placeholder="Server"></td>
    </tr>
    <tr>
        <td>Port</td>
        <td><input name="device.port" value="${data.get('device.port','1883')|h}" placeholder="Port"></td>
    </tr>
 
    <tr>
        <td>Password(Empty for anon)</td>
        <td><input name="device.password" value="${data.get('device.password','')|h}" placeholder="PW"></td>
    </tr>
    <tr>
        <td>MQTT Topic</td>
        <td><input name="device.mqtttopic" value="${data.get('device.mqtttopic','/ble/')|h}" placeholder="PW"></td>
    </tr>
</table>
