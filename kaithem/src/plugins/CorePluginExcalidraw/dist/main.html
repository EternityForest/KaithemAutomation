<!DOCTYPE html>
<html lang="en">

<head>
    <title>Excalidraw in browser</title>
    <script>
        window.EXCALIDRAW_ASSET_PATH = "/plugin-excalidraw/dist/";

    </script>
    <script src="./react.production.min.js"></script>
    <script src="./react-dom.production.min.js"></script>

    <script src="./excalidraw.production.min.js"></script>

</head>

<body>
    <div class="container">
        <h1>Excalidraw Embed Example</h1>
        <div id="app"></div>
    </div>
    <script>

        function MainMenu() {

            const pathOpen = 'm9.257 6.351.183.183H15.819c.34 0 .727.182 1.051.506.323.323.505.708.505 1.05v5.819c0 .316-.183.7-.52 1.035-.337.338-.723.522-1.037.522H4.182c-.352 0-.74-.181-1.058-.5-.318-.318-.499-.705-.499-1.057V5.182c0-.351.181-.736.5-1.054.32-.321.71-.503 1.057-.503H6.53l2.726 2.726Z';
            const pathExport = 'M3.333 14.167v1.666c0 .92.747 1.667 1.667 1.667h10c.92 0 1.667-.746 1.667-1.667v-1.666M5.833 9.167 10 13.333l4.167-4.166M10 3.333v10';
            const pathSave = 'M15 8h.01 M12 20h-5a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v5 M4 15l4 -4c.928 -.893 2.072 -.893 3 0l4 4 M14 14l1 -1c.617 -.593 1.328 -.793 2.009 -.598 M19 16v6 M22 19l-3 3l-3 -3';

            const iconFill = { fill: 'none', stroke: 'currentColor', 'stroke-width': '1.25', 'stroke-linecap': 'round', 'stroke-linejoin': 'round' };
            const iconVB20 = { viewBox: '0 0 20 20', ...iconFill };
            const iconVB24 = { viewBox: '0 0 24 24', ...iconFill };

            const iconOpen = React.createElement('svg', iconVB20, React.createElement('path', { d: pathOpen }));
            const iconExport = React.createElement('svg', iconVB20, React.createElement('path', { d: pathExport }));
            const iconSave = React.createElement('svg', iconVB24, React.createElement('path', { d: pathSave }));

            const Menu = [
                React.createElement(ExcalidrawLib.MainMenu.DefaultItems.LoadScene),
                React.createElement(ExcalidrawLib.MainMenu.Item, { icon: iconExport, onClick: () => SAVE() }, 'Save to Server'),
                React.createElement( ExcalidrawLib.MainMenu.DefaultItems.SaveAsImage),
                React.createElement(ExcalidrawLib.MainMenu.DefaultItems.ClearCanvas),
                React.createElement(ExcalidrawLib.MainMenu.Separator),
                React.createElement(ExcalidrawLib.MainMenu.DefaultItems.ToggleTheme),
                React.createElement(ExcalidrawLib.MainMenu.DefaultItems.ChangeCanvasBackground),
            ]

            return Menu;
        }

        function LOADCB(e){ 
                  
            const library = e.library == '' ? '' : JSON.parse(e.library);
           
            const SCENE = e.scene;
            const type  = SCENE.type;
            const ext   = SCENE.ext;
            let scene    = SCENE.content;                     
 
            //Open SCENE from PNG medata
            if( type == 'image' ) {
            
                const blob = b64ToBlob( scene, ext );        //base64 png data -> blob
                 
                ExcalidrawLib.loadFromBlob(blob)              //extract scene from png metadata 
                .then( scene => INIT( library, scene ) );
            }
            //Open SCENE from JSON file.excalidraw
            else {
            
                if( type == 'scene' ) scene = JSON.parse(scene); 
                else scene = {};                              //no Scene, just open Excalidraw empty
                
                INIT( library, scene );
            }
         }


        const App = () => {
   
            [excalidrawAPI, setExcalidrawAPI] = React.useState(null);
   
             return React.createElement(
                       React.Fragment, null,
                         React.createElement( 'div', { style: { height: "100vh" } },
                           React.createElement( ExcalidrawLib.Excalidraw, {}, 
                              React.createElement( ExcalidrawLib.MainMenu, {}, MainMenu() ), 
                           ),   
                         ),
                       );
          };

        const excalidrawWrapper = document.getElementById("app");
        const root = ReactDOM.createRoot(excalidrawWrapper);
        root.render(React.createElement(App));


    </script>
</body>
</html>