import json

persistancedicts = {}

#This is only used for checking if a dict already exists and creating it with defaults if not.
persistance_dict_connection_lock = threading.RLock()


class PersistanceFile(object):

    def __init__(self,filename,defaults):
        with persistance_dict_connection_lock:
            if filename in persistancedicts:
                self.d = persistancedicts[filename]
                for i in defaults:
                    if i not in self.d:
                        self.d[i] = defaults[i]
            else:
                self.d = defaults

        self.lock = threading.lock

    def write(path,value):
        with self.lock:
            if isinstance(value,list):
                self.d[path] = [value]

    def append(path,value):
        with self.lock:
            if d
            self.d[path

