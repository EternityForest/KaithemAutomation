<script type="2b8c68ea-307c-4558-bf34-5e024c8306f4">
    #This script is only to configure metadata, 
    #it is not JS and is not included in  the page
    
    allow-origins: ['*']
    allow-xss: false
    auto-reload: false
    auto-reload-interval: 5.0
    dont-show-in-index: false
    mimetype: text/html
    no-header: false
    no-navheader: true
    require-method: [GET, POST]
    require-permissions: []
    resource-timestamp: 1566264981186437
    resource-type: page
    template-engine: mako
</script>

<%!
#Code Here runs once when page is first rendered. Good place for import statements.
__doc__= ""
%>
<%
if request.method=="POST" and 'folders' in kwargs:
    kaithem.registry.set("lighting/soundfolders",[i.strip() for i in kwargs['folders'].split('\n') if i])
if request.method=="POST":
        kaithem.registry.set("lighting/nettime",'nettime' in kwargs)
        module.maketimefunc()
%>
<h2>Lighting Setup</h2>
<title>Setup</title>

<div class="sectionbox">

    <form method="POST">
    <p class="help">Auto-discover an NTP server for lighting control using MDNS. Note that every kaithem instance acts as an NTP server as well. Changing this with running scenes may
        cause odd behaviour, but shouldn't cause a crash. If no NTP server is found, uses system time as normal. This is a global setting for the entire lighting subsystem.
    </p>
        <label><input name="nettime" type="checkbox"
        %if kaithem.registry.get("lighting/nettime",False):
        checked="1"
        %endif
        
        >Use LAN Consenseus time</label><br>
    <p class="help">Enter the sound folders here, as full paths, one per line. Submit to save
        to the kaithem registry, save the server state to maek changes persistant.
    </p>
        <textarea name="folders">${'\n'.join(kaithem.registry.get("lighting/soundfolders",[]))}</textarea>
        <br>
        <input type="submit"></form>
    </form>
</div>