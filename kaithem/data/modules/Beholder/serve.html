---
allow-origins: ['*']
allow-xss: false
auto-reload: false
auto-reload-interval: 5.0
mimetype: text/html
no-header: false
no-navheader: false
require-method: [GET, POST]
require-permissions: []
resource-timestamp: 1645235594542772
resource-type: page
template-engine: mako

---
<%!
#Code Here runs once when page is first rendered. Good place for import statements.
import os
%>

<%

device = kaithem.devices[path[1]]
for i in kaithem.devices[path[1]].config.get('kaithem.read_perms','').strip().split(","):
    if not kaithem.web.hasPermission(i):
        raise RuntimeError("Missing permission for that camera: "+repr(i))

dir = os.path.expanduser(device.config['device.storage_dir'])
kaithem.web.serveFile(os.path.join(dir,*path[1:]))

%>

