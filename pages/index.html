<%!
    import socket
    import time
    import os

    if os.name != "nt":
        import fcntl
        import struct

        def get_interface_ip(ifname):
            s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
            return socket.inet_ntoa(fcntl.ioctl(s.fileno(), 0x8915, struct.pack('256s',
                                    ifname[:15].encode('utf-8') ))[20:24])

    def get_lan_ip():
        ip = socket.gethostbyname(socket.gethostname())
        if ip.startswith("127.") and os.name != "nt":
            interfaces = [
                "eth0",
                "eth1",
                "eth2",
                "wlan0",
                "wlan1",
                "wifi0",
                "ath0",
                "ath1",
                "ppp0",
                ]
            for ifname in interfaces:
                try:
                    ip = get_interface_ip(ifname)
                    break
                except IOError:
                    pass
        return ip
        
%>



<%include file="/pageheader.html"/>
<title>Kaithem Automation</title>

<div class="sectionbox">
<p><b>Kaithem is free software licensed under the GPLv3.<br>
Kaithem was not designed for mission critical or safety of life systems and no warranty is expressed or implied.<br>
Use entirely at your own risk.</b></p>

<p>Do NOT create any resources or users with unicode names on python 2</p>
</div class="sectionbox">

<div class="sectionbox">
<p>Logged into Kaithem Automation as user: ${user}</p>
</div>

<div class="sectionbox">
<p>
<b>IP Data</b>
<table border=1>
<tr>
<td>LAN IP Adress</td>
<td>${get_lan_ip()}</td>
</tr><tr>
<td>WAN(Public) IP</td>
<td>${myip.decode()}</td>
</tr>
</table>
</p>
</div>
<%include file="/pagefooter.html"/>
